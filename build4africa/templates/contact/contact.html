{% extends 'base.html' %}
{% load static %}

{% block title %}Contact Us - Build4Africa{% endblock %}

{% block content %}
<!-- Contact Section -->
<section class="contact-section section-padding" id="section_6">
    <div class="container">
        <div class="row">
            <!-- Contact Info Column -->
            <div class="col-lg-4 col-12 ms-auto mb-5 mb-lg-0">
                <div class="contact-info-wrap">
                    <h2>Get in touch</h2>

                    <div class="contact-image-wrap d-flex flex-wrap">
                        <img src="{% static 'images/3d-cartoon-avatar.jpg' %}" class="img-fluid avatar-image" alt="Contact Person"> 
                

                        <div class="d-flex flex-column justify-content-center ms-3">
                            <p class="mb-0">Assistant</p>
                            <p class="mb-0"><strong>Director of Community Engagement</strong></p>
                        </div>
                    </div>

                    <div class="contact-info">
                        <h5 class="mb-3">Contact Information</h5>

                        <p class="d-flex mb-2">
                            <i class="bi-geo-alt me-2"></i>
                            Innovation Hub, 24 Digital Drive, Lagos
                        </p>

                        <p class="d-flex mb-2">
                            <i class="bi-telephone me-2"></i>
                            <a href="tel:+2348001234567">
                                +234 234-XXX-XXX-XXXX
                            </a>
                        </p>

                        <p class="d-flex">
                            <i class="bi-envelope me-2"></i>
                            <a href="mailto:contact@build4africa.org">
                                contact@build4africa.org
                            </a>
                        </p>

                        <a href="https://maps.google.com/?q=Innovation+Hub,+24+Digital+Drive,+Lagos" 
                           class="custom-btn btn mt-3">Get Direction</a>
                    </div>
                </div>
            </div>

            <!-- Contact Form Column -->
            <div class="col-lg-5 col-12 mx-auto">
                <form class="custom-form contact-form" action="{% url 'contact' %}" method="post" role="form" id="contact-form">
                    {% csrf_token %}
                    
                    <h2>Contact form</h2>

                    <p class="mb-4">Or, you can just send an email:
                        <a href="mailto:adedotunafeez007@gmail.com">contact@build4africa.org</a>
                    </p>
                    
                    <div class="row">
                        <div class="col-lg-6 col-md-6 col-12">
                            <input type="text" name="first_name" id="first-name" class="form-control" 
                                   placeholder="First Name" required>
                        </div>

                        <div class="col-lg-6 col-md-6 col-12">
                            <input type="text" name="last_name" id="last-name" class="form-control" 
                                   placeholder="Last Name" required>
                        </div>
                    </div>

                    <input type="email" name="email" id="email" pattern="[^ @]*@[^ @]*" 
                           class="form-control" placeholder="Email Address" required>

                    <select name="interest" class="form-control mb-3" required>
                        <option value="" disabled selected>I'm interested in...</option>
                        <option value="youth">Youth Empowerment</option>
                        <option value="governance">Civic Tech</option>
                        <option value="fintech">Financial Inclusion</option>
                        <option value="education">eLearning</option>
                    </select>

                    <textarea name="message" rows="5" class="form-control" id="message" 
                              placeholder="How can we help you?"></textarea>

                    <button type="submit" class="custom-btn btn form-control mt-4" id="submit-btn">Send Message</button>
                </form>
                
                <div id="contact-success" style="display: none;">
                    <div class="alert alert-success mt-4">
                        <h4>Thank you for contacting us!</h4>
                        <p>We've received your message and will get back to you soon.</p>
                    </div>
                </div>
                
                <div id="contact-error" style="display: none;">
                    <div class="alert alert-danger mt-4">
                        <h4>Error sending message</h4>
                        <p>Please try again later or email us directly at <a href="mailto:contact@build4africa.org">contact@build4africa.org</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const contactForm = document.getElementById('contact-form');
        
        if (contactForm) {
            contactForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const submitBtn = contactForm.querySelector('button[type="submit"]');
                const originalText = submitBtn.textContent;
                
                // Show loading state
                submitBtn.disabled = true;
                submitBtn.innerHTML = `
                    <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                    Sending...
                `;
                
                try {
                    const formData = new FormData(contactForm);
                    const response = await fetch(contactForm.action, {
                        method: 'POST',
                        body: formData,
                        headers: {
                            'X-Requested-With': 'XMLHttpRequest',
                            'X-CSRFToken': contactForm.querySelector('[name=csrfmiddlewaretoken]').value,
                        }
                    });
    
                    const data = await response.json();
                    
                    if (!response.ok) {
                        throw new Error(data.error || 'Server error');
                    }
    
                    if (data.success) {
                        // Success case
                        contactForm.style.display = 'none';
                        document.getElementById('contact-success').style.display = 'block';
                        document.getElementById('contact-error').style.display = 'none';
                        
                        // Reset form after 5 seconds
                        setTimeout(() => {
                            contactForm.reset();
                            contactForm.style.display = 'block';
                            document.getElementById('contact-success').style.display = 'none';
                        }, 5000);
                    } else {
                        throw new Error(data.error || 'Failed to send message');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    document.getElementById('contact-error').style.display = 'block';
                    document.getElementById('contact-success').style.display = 'none';
                    
                    // Scroll to error message
                    document.getElementById('contact-error').scrollIntoView({
                        behavior: 'smooth',
                        block: 'center'
                    });
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.textContent = originalText;
                }
            });
        }
    });
    </script>
{% endblock %}